# NeXus Tomography-Segmentation Builder 

A Python package for creating NeXus-compliant files from segmented tomography data.

## Features

- ✅ Create NeXus NXtomo files from segmented 3D volumes
- ✅ Define multiple phases with physical properties
- ✅ Store thermal and mechanical characterisation data
- ✅ Track processing provenance
- ✅ Calculate phase statistics automatically
- ✅ Full NeXus standard compliance

## Installation

### From source (development)

```bash
git clone https://github.com/yourusername/nxtomo-builder.git
cd nxtomo-builder
pip install -e .
```


## Quick Start

### From NumPy Array

```python
from nxtomo_segmentation_builder import create_nexus_tomo_file
import numpy as np

# Your segmented data
data = np.load('segmented_volume.npy')  # Shape: (z, y, x)

# Create NeXus file
create_nexus_tomo_file(
    output_file='output.nxs',
    data=data,
    voxel_size=[1.0, 1.0, 1.0],  # micrometers
    title="My Segmented Tomography",
    sample_name="Foam Sample",
    sample_description="Polyurethane foam"
)
```

### From Raw Binary File

```python
from nxtomo_segmentation_builder import create_nexus_from_raw_file

create_nexus_from_raw_file(
    raw_file_path='data.raw',
    output_file='output.nxs',
    shape=(200, 200, 200),
    voxel_size=[0.5, 0.5, 0.5],
    title="Lab Tomography",
    sample_name="Sample A"
)
```

### With Phase Definitions

```python
phase_config = {
    0: ("Air/Pore", "Void space"),
    1: ("Polymer Matrix", "Solid phase"),
    2: ("Glass Fiber", "Reinforcement")
}

thermal_props = {
    'conductivity': [0.026, 0.2, 1.5],
    'conductivity_units': 'W/(m*K)'
}

create_nexus_tomo_file(
    output_file='output.nxs',
    data=data,
    voxel_size=[1.0, 1.0, 1.0],
    title="Multi-phase Material",
    sample_name="Composite",
    phase_config=phase_config,
    thermal_props=thermal_props
)
```

## Usage in Jupyter Notebooks

```python
# Import the package
from nxtomo_builder import create_nexus_tomo_file
import numpy as np

# Load your data
data = np.load('my_segmentation.npy')

# Create file
output = create_nexus_tomo_file(
    output_file='analysis.nxs',
    data=data,
    voxel_size=[2.0, 2.0, 2.0],
    title="Jupyter Analysis",
    sample_name="Test"
)

print(f"Created: {output}")
```

## Documentation

Full documentation available at: [link to docs]

### API Reference

- `create_nexus_tomo_file()` - Main function to create NeXus from array
- `create_nexus_from_raw_file()` - Create NeXus from raw binary file
- `load_raw_data()` - Load raw binary data
- Helper functions for creating individual NeXus components

See the [examples notebook](notebooks/examples.ipynb) for detailed usage.

## Requirements

Tested on:
- Python ≥ 3.8
- numpy ≥ 1.20.0
- nexusformat ≥ 1.0.0
- h5py ≥ 3.0.0

## Examples

Check the `notebooks/` directory for Jupyter notebook examples:
- `basic_usage.ipynb` - Simple examples
- `advanced_features.ipynb` - Phase definitions and properties
- `from_raw_file.ipynb` - Loading from raw binary files

## Development

### Setup development environment

```bash
git clone https://github.com/yourusername/nxtomo-builder.git
cd nxtomo-builder
pip install -e ".[dev,jupyter]"
```

## License

MIT License - see LICENSE file for details


## Acknowledgments

DIADEM PEPR